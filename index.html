<!-- file: index.html -->
<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#111111" />
    <title>√în t·ª´ v·ª±ng Nh·∫≠t</title>

    <link rel="stylesheet" href="assets/css/app.css" />
  </head>

  <body>
    <div class="container">
      <!-- Header -->
      <div class="card">
        <div class="headerRow">
          <div class="flex">
            <span class="badge"><b>Offline</b></span>
            <span class="badge"
              ><b>Ch·ªß ƒë·ªÅ:</b> <span id="topicActive">-</span></span
            >
            <span class="badge"
              ><b>Timer:</b> <span id="timerLabel">10</span>s</span
            >
            <span class="badge"
              ><b>Vocab:</b> <span id="vocabCount">0</span></span
            >
            <span class="badge"
              ><b>Topics:</b> <span id="topicCount">0</span></span
            >
            <span class="badge"
              ><b>Ng∆∞·ªùi ch∆°i:</b> <span id="playerCount">0</span></span
            >
            <span class="badge"
              ><b>ƒê·ªô kh√≥:</b> <span id="difficultyLabel">1</span></span
            >
          </div>

          <div class="flex">
            <button
              class="btn tab"
              id="btnOpenSettings"
              data-panel="panelSettings"
            >
              Thi·∫øt l·∫≠p
            </button>
            <button class="btn tab" id="btnOpenTopics" data-panel="panelTopics">
              Ch·ªß ƒë·ªÅ
            </button>
            <button class="btn tab" id="btnOpenVocab" data-panel="panelVocab">
              T·ª´ v·ª±ng
            </button>
            <button class="btn tab" id="btnOpenIO" data-panel="panelIO">
              Import/Export
            </button>
            <button class="btn" id="btnResetAll">Reset</button>
          </div>
        </div>

        <div class="hint">
          v6.6.2: Panels m·ªü ngay d∆∞·ªõi header (toggle tabs) + Board mode
          AUTO/SQUARE.
        </div>
      </div>

      <!-- Panels (Top) -->
      <div class="panelStack" id="panelStackTop">
        <!-- Settings -->
        <div id="panelSettings" class="card hidden">
          <div class="panelHeader">
            <h3>Thi·∫øt l·∫≠p</h3>
            <button class="btn" data-close="panelSettings">ƒê√≥ng</button>
          </div>

          <div class="twoCols">
            <div>
              <div class="small">Timer (1‚Äì120s)</div>
              <input
                class="input"
                type="number"
                min="1"
                max="120"
                id="timerInput"
                value="10"
              />
            </div>

            <div>
              <div class="small">Board mode</div>
              <select class="select" id="boardModeSelect">
                <option value="AUTO">
                  AUTO (t·ª± t√≠nh s·ªë √¥ theo vocab topic)
                </option>
                <option value="SQUARE">SQUARE (N x N)</option>
              </select>
            </div>
          </div>

          <div class="twoCols" style="margin-top: 10px">
            <div>
              <div class="small" id="boardSizeLabel">K√≠ch th∆∞·ªõc b·∫£ng</div>
              <input
                class="input"
                type="number"
                min="3"
                max="30"
                id="boardSizeInput"
                value="10"
              />
              <div class="hint" id="boardSizeHint">
                AUTO: ƒë√¢y l√† s·ªë c·ªôt hi·ªÉn th·ªã.
              </div>
            </div>

            <div>
              <div class="small">ƒê·ªô kh√≥ (1‚Äì6)</div>
              <select class="select" id="difficultySelect">
                <option value="1">1 ‚Äî D·ªÖ nh·∫•t: 1 t·ª´ / √¥</option>
                <option value="2">2 ‚Äî 2 t·ª´ / √¥</option>
                <option value="3">3 ‚Äî 3 t·ª´ / √¥</option>
                <option value="4">4 ‚Äî 1‚Äì3 t·ª´ / √¥ + th√™m ng·ªØ ph√°p</option>
                <option value="5">5 ‚Äî 1‚Äì3 t·ª´ / √¥ + th√™m ch·ªØ H√°n</option>
                <option value="6">
                  6 ‚Äî Cao nh·∫•t: 1‚Äì3 t·ª´ / √¥ + random ng·ªØ ph√°p/ch·ªØ H√°n
                </option>
              </select>

              <div class="hint">
                C·∫•p 6: m·ªói √¥ random: kh√¥ng add-on / ch·ªâ ng·ªØ ph√°p / ch·ªâ ch·ªØ H√°n /
                c·∫£ hai.
              </div>
            </div>
          </div>

          <div class="twoCols" style="margin-top: 10px">
            <div>
              <div class="small">Ch·∫ø ƒë·ªô ph√°t phi·∫øu</div>
              <select class="select" id="dealMode">
                <option value="ALL">ALL: ph√°t cho t·∫•t c·∫£ (1..N-1)</option>
                <option value="TOPK">TOP-K: ph√°t 1..K (t√πy bu·ªïi h·ªçc)</option>
              </select>
            </div>

            <div>
              <div class="small">K (ch·ªâ d√πng TOP-K)</div>
              <input
                class="input"
                type="number"
                min="1"
                max="999999"
                id="dealK"
                value="10"
              />
            </div>
          </div>
        </div>

        <!-- Topics -->
        <div id="panelTopics" class="card hidden">
          <div class="panelHeader">
            <h3>Ch·ªß ƒë·ªÅ</h3>
            <button class="btn" data-close="panelTopics">ƒê√≥ng</button>
          </div>

          <div class="hint">
            Ch·ªß ƒë·ªÅ ƒë·ªôc l·∫≠p v·ªõi vocab. C√≥ icon (emoji) ho·∫∑c ·∫£nh local. Labels
            d√πng ·ªü stage 0.
          </div>

          <div class="twoCols" style="margin-top: 10px">
            <div>
              <div class="small">T√™n ch·ªß ƒë·ªÅ</div>
              <input
                class="input"
                id="topicName"
                placeholder="VD: ƒê·ªông v·∫≠t / ƒê·ªãa danh / ..."
              />
            </div>

            <div>
              <div class="small">Icon (emoji)</div>
              <input class="input" id="topicIcon" placeholder="VD: üêæ" />
            </div>
          </div>

          <div style="margin-top: 10px">
            <div class="small">·∫¢nh ch·ªß ƒë·ªÅ (ƒë∆∞·ªùng d·∫´n local)</div>
            <input
              class="input"
              id="topicImage"
              placeholder="VD: images/topics/animals.jpg"
            />
          </div>

          <div class="flex" style="margin-top: 10px">
            <button class="btn primary" id="btnAddTopic">Th√™m ch·ªß ƒë·ªÅ</button>
            <button class="btn" id="btnClearTopicForm">X√≥a form</button>
          </div>

          <hr />
          <div id="topicsTable"></div>
        </div>

        <!-- Vocab -->
        <div id="panelVocab" class="card hidden">
          <div class="panelHeader">
            <h3>T·ª´ v·ª±ng</h3>
            <button class="btn" data-close="panelVocab">ƒê√≥ng</button>
          </div>

          <div class="hint">IndexedDB gi√∫p l∆∞u r·∫•t nhi·ªÅu vocab offline.</div>

          <div class="twoCols" style="margin-top: 10px">
            <div>
              <div class="small">Ch·ªß ƒë·ªÅ</div>
              <select class="select" id="vocabTopic"></select>
            </div>

            <div>
              <div class="small">JP (b·∫Øt bu·ªôc)</div>
              <input class="input" id="vocabJp" placeholder="VD: „Å≠„Åì" />
            </div>
          </div>

          <div class="twoCols" style="margin-top: 10px">
            <div>
              <div class="small">Kana</div>
              <input class="input" id="vocabKana" placeholder="VD: „Å≠„Åì" />
            </div>

            <div>
              <div class="small">Nghƒ©a (b·∫Øt bu·ªôc)</div>
              <input
                class="input"
                id="vocabMeaning"
                placeholder="VD: con m√®o"
              />
            </div>
          </div>

          <div style="margin-top: 10px">
            <div class="small">V√≠ d·ª• (ng·ªØ ph√°p)</div>
            <textarea
              id="vocabExample"
              placeholder="VD: „Å≠„Åì„ÅåÂ•Ω„Åç„Åß„Åô„ÄÇ"
            ></textarea>
          </div>

          <div style="margin-top: 10px">
            <div class="small">H√°n vi·ªát / ch·ªØ H√°n (n·∫øu c√≥)</div>
            <input class="input" id="vocabHanviet" placeholder="VD: Áå´: Mi√™u" />
          </div>

          <div class="twoCols" style="margin-top: 10px">
            <div>
              <div class="small">Icon (emoji) c·ªßa t·ª´</div>
              <input class="input" id="vocabIcon" placeholder="VD: üê±" />
            </div>

            <div>
              <div class="small">·∫¢nh (ƒë∆∞·ªùng d·∫´n local) c·ªßa t·ª´</div>
              <input
                class="input"
                id="vocabImage"
                placeholder="VD: images/animals/cat.png"
              />
            </div>
          </div>

          <div class="flex" style="margin-top: 10px">
            <button class="btn primary" id="btnAddVocab">Th√™m t·ª´</button>
            <button class="btn" id="btnClearVocabForm">X√≥a form</button>
          </div>

          <hr />

          <div class="twoCols">
            <input
              class="input"
              id="vocabSearch"
              placeholder="l·ªçc theo jp/nghƒ©a/topic..."
            />
            <button class="btn" id="btnExportCsv">
              Xu·∫•t CSV (phi·∫øu v√≤ng hi·ªán t·∫°i)
            </button>
          </div>

          <div id="vocabTable" style="margin-top: 10px"></div>
        </div>

        <!-- Import / Export -->
        <div id="panelIO" class="card hidden">
          <div class="panelHeader">
            <h3>Import / Export</h3>
            <button class="btn" data-close="panelIO">ƒê√≥ng</button>
          </div>

          <div class="grid" style="margin-top: 10px">
            <div class="twoCols">
              <div>
                <div class="small">
                  Nh·∫≠p JSON FULL (topics + vocab + state) ‚Äî t√πy ch·ªçn
                </div>
                <input
                  class="input"
                  type="file"
                  id="jsonFile"
                  accept="application/json"
                />
                <div class="hint">
                  Ch·∫•p nh·∫≠n:
                  <span class="mono"
                    >{"topics":[...],"vocab":[...],"state":{...}}</span
                  >
                  ho·∫∑c m·∫£ng vocab (legacy).
                </div>
              </div>

              <div>
                <div class="small">Xu·∫•t JSON hi·ªán t·∫°i</div>
                <button class="btn" id="btnExport">T·∫£i JSON</button>
                <div class="hint">
                  Xu·∫•t topics + vocab + state + board tiles.
                </div>
              </div>
            </div>

            <hr />

            <div class="twoCols">
              <div>
                <div class="small">
                  Nh·∫≠p Topics ri√™ng (ch·ªâ ƒë·ªïi ch·ªß ƒë·ªÅ, kh√¥ng ƒë·ª•ng vocab)
                </div>
                <input
                  class="input"
                  type="file"
                  id="topicsFile"
                  accept="application/json"
                />
                <div class="hint">
                  Format:
                  <span class="mono"
                    >{"topics":[{"id","name","icon?","image?","labels?"}...]}</span
                  >
                </div>
              </div>

              <div>
                <div class="small">Nh·∫≠p Vocab ri√™ng</div>
                <input
                  class="input"
                  type="file"
                  id="vocabFile"
                  accept="application/json"
                />
                <div class="hint">
                  Format: <span class="mono">{"vocab":[...]}</span> ho·∫∑c legacy
                  <span class="mono">[ ... ]</span>
                </div>

                <div style="margin-top: 8px">
                  <div class="small">Ch·∫ø ƒë·ªô nh·∫≠p vocab</div>
                  <select class="select" id="vocabImportMode">
                    <option value="MERGE" selected>
                      MERGE (th√™m/ghi ƒë√® theo id) ‚Äî KH√îNG x√≥a d·ªØ li·ªáu c≈©
                    </option>
                    <option value="REPLACE">
                      REPLACE (x√≥a h·∫øt vocab r·ªìi nh·∫≠p l·∫°i)
                    </option>
                  </select>
                </div>
              </div>
            </div>

            <hr />

            <div class="flex">
              <button class="btn danger" id="btnClearVocabOnly">
                X√≥a to√†n b·ªô vocab
              </button>
              <button class="btn danger" id="btnClearTopicsOnly">
                X√≥a to√†n b·ªô topics (reset m·∫∑c ƒë·ªãnh)
              </button>
            </div>

            <div class="hint">Reset to√†n b·ªô = n√∫t Reset tr√™n header.</div>
          </div>
        </div>
      </div>

      <!-- Main -->
      <div class="row">
        <!-- Left -->
        <div class="grid">
          <!-- Play -->
          <div class="card">
            <h3>Ch∆°i</h3>

            <div class="flex">
              <button class="btn primary" id="btnDeal">
                Ph√°t phi·∫øu (v√≤ng m·ªõi)
              </button>
              <button class="btn" id="btnNewBoard">B·∫£ng m·ªõi</button>
            </div>

            <div class="card" style="border: 1px solid #eee; margin-top: 10px">
              <div class="small" style="color: #777">
                ƒêANG ƒê∆Ø·ª¢C G·ªåI (leader + m·ªôt ph·∫ßn ƒë·∫ßu ƒë·ªÉ nh·∫π m√°y)
              </div>

              <div id="currentCall" class="flex" style="margin-top: 6px"></div>

              <div class="hint">
                Ph√≤ng ƒë√¥ng: d√πng √¥ t√¨m s·ªë ƒë·ªÉ g·ªçi ƒë√∫ng ng∆∞·ªùi.
              </div>
            </div>
          </div>

          <!-- Players -->
          <div class="card">
            <h3>Ng∆∞·ªùi ch∆°i</h3>

            <div class="twoCols">
              <div>
                <div class="small">T√™n ng∆∞·ªùi ch∆°i (th√™m gi·ªØa bu·ªïi ƒë∆∞·ª£c)</div>
                <input
                  class="input"
                  id="playerName"
                  placeholder="VD: Lan / H∆∞∆°ng / ..."
                />
              </div>

              <div style="align-self: end">
                <button class="btn primary" id="btnAddPlayer">
                  Th√™m ng∆∞·ªùi ch∆°i
                </button>
              </div>
            </div>

            <div class="twoCols" style="margin-top: 10px">
              <div>
                <div class="small">T√¨m (t√™n / s·ªë b·∫•t k·ª≥ / 3bich)</div>
                <input
                  class="input"
                  id="playerSearch"
                  placeholder="VD: 57 ho·∫∑c Lan ho·∫∑c 3bich..."
                />
                <div class="hint">
                  Max s·ªë v√≤ng hi·ªán t·∫°i: <b id="maxNumberLabel">-</b>
                </div>
              </div>

              <div style="align-self: end">
                <button class="btn" id="btnClearSearch">X√≥a l·ªçc</button>
              </div>
            </div>

            <div
              class="flex"
              style="justify-content: space-between; margin-top: 10px"
            >
              <span class="badge" id="showingCount">0/0</span>
              <button class="btn primary" id="btnToggleHistory">
                Check phi·∫øu
              </button>
            </div>

            <div class="players" id="playersBox" style="margin-top: 10px"></div>

            <div id="roundsWrap" class="hidden" style="margin-top: 10px">
              <hr />

              <div class="panelHeader">
                <h3 style="margin: 0">L·ªãch s·ª≠ ph√°t phi·∫øu</h3>
                <button class="btn" id="btnHideHistoryInline">·∫®n phi·∫øu</button>
              </div>

              <div class="hint">Hi·ªÉn th·ªã 30 v√≤ng g·∫ßn nh·∫•t.</div>
              <div id="roundsBox" class="grid" style="margin-top: 10px"></div>
            </div>
          </div>
        </div>

        <!-- Right -->
        <div class="grid">
          <div class="card">
            <h3>B·∫£ng √¥</h3>
            <div class="small" style="margin-bottom: 10px">
              Nh·∫•n 1 l·∫ßn: JP (+ timer). Nh·∫•n 2 l·∫ßn: nghƒ©a/ƒë·ªçc + ph·∫ßn b·ªï sung
              (t√πy ƒë·ªô kh√≥).
            </div>

            <div class="tiles" id="tilesBox"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="toast" id="toast"></div>

    <!-- Script -->
    <script src="assets/js/app.js" defer></script>
  </body>
</html>
